{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-21440e22\",\"chunk-2d0c956b\",\"chunk-2d0a4d8f\"],{\"07d6\":function(t,e,n){\"use strict\";n.r(e);var s=n(\"a34a\"),r=n.n(s),a=n(\"ceda\");function i(t,e,n,s,r,a,i){try{var c=t[a](i),o=c.value}catch(u){return void n(u)}c.done?e(o):Promise.resolve(o).then(s,r)}function c(t){return function(){var e=this,n=arguments;return new Promise(function(s,r){var a=t.apply(e,n);function c(t){i(a,s,r,c,o,\"next\",t)}function o(t){i(a,s,r,c,o,\"throw\",t)}c(void 0)})}}function o(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function u(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function l(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}var p=function(){function t(){o(this,t)}return l(t,[{key:\"searchReportList\",value:function(){var t=c(r.a.mark(function t(e){var n;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(a[\"post\"])(\"/autotest/report/list\",e);case 2:return n=t.sent,t.abrupt(\"return\",n);case 4:case\"end\":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()},{key:\"getReportDetail\",value:function(){var t=c(r.a.mark(function t(e){var n;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(a[\"get\"])(\"/autotest/report/\".concat(e));case 2:return n=t.sent,t.abrupt(\"return\",n);case 4:case\"end\":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()},{key:\"execute\",value:function(){var t=c(r.a.mark(function t(e){var n;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(a[\"post\"])(\"/autotest/report/execute/\".concat(e));case 2:return n=t.sent,t.abrupt(\"return\",n);case 4:case\"end\":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()}]),t}();e[\"default\"]=new p},\"180e\":function(t,e,n){},\"3c12\":function(t,e,n){\"use strict\";var s=n(\"180e\"),r=n.n(s);r.a},\"595f\":function(t,e,n){\"use strict\";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",[n(\"el-table\",{attrs:{data:t.result,stripe:\"\"}},[n(\"el-table-column\",{attrs:{prop:\"actual_value\",label:\"实际取值\",\"show-overflow-tooltip\":\"\"}}),n(\"el-table-column\",{attrs:{prop:\"compare_value\",label:\"断言方式\"}}),n(\"el-table-column\",{attrs:{prop:\"expected_value\",label:\"预期值\"}}),n(\"el-table-column\",{attrs:{prop:\"extract_value\",label:\"结果\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[n(\"el-tag\",{attrs:{type:\"通过\"===e.row.extract_value?\"success\":\"danger\",\"disable-transitions\":\"\"}},[t._v(t._s(e.row.extract_value))])]}}])})],1)],1)},r=[],a={props:{result:{type:Array}},watch:{result:function(){this.getResult()}},mounted:function(){this.getResult()},data:function(){return{compare_list:{1:\"相等\",2:\"包含\",3:\"不为空或null\"}}},methods:{getResult:function(){var t=this;this.result.forEach(function(e){e.compare_value=t.compare_list[e.compare_type],e.extract_value=e.extract_success?\"通过\":\"失败\"})}}},i=a,c=n(\"2877\"),o=Object(c[\"a\"])(i,s,r,!1,null,\"c198130c\",null);e[\"default\"]=o.exports},\"7cc3\":function(t,e,n){\"use strict\";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"container\"},[n(\"div\",{staticClass:\"case-info\"},[n(\"el-card\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.report_loading,expression:\"report_loading\"}],staticClass:\"ring-card\"},[n(\"ve-ring\",{staticClass:\"ring\",attrs:{data:t.chartData,settings:t.chartSettings,extend:t.chartExtend}})],1),n(\"el-card\",{staticClass:\"case-list\"},[t.report_loading?n(\"div\",{staticClass:\"progress-div\"},[n(\"el-progress\",{staticStyle:{margin:\"20px auto\"},attrs:{type:\"circle\",percentage:t.percentage,width:160,\"stroke-width\":16}})],1):t._e(),n(\"div\",{staticStyle:{height:\"500px\"}},[n(\"vue-scroll\",t._l(t.result_list,function(e){return n(\"div\",{key:e.index,class:{\"case-title-normal\":!e.is_choose,\"case-title-choose\":e.is_choose},on:{click:function(n){return t.getCaseDetail(e)}}},[e.expected_is_pass?n(\"i\",{staticClass:\"el-icon-success icon\",staticStyle:{color:\"#00C292\"}}):e.expected_is_pass?t._e():n(\"i\",{staticClass:\"el-icon-error icon\",staticStyle:{color:\"#E46A76\"}}),n(\"span\",{staticClass:\"title\"},[t._v(\"\\n            \"+t._s(e.case_name)+\"\\n            \")])])}),0)],1)])],1),n(\"el-card\",{staticClass:\"case-detail\"},[n(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.case_choose,expression:\"case_choose\"}]},[n(\"div\",{staticClass:\"header\"},[n(\"div\",{staticClass:\"title\"},[t._v(\"\\n          \"+t._s(t.case_detail.case_name)+\"\\n        \")]),n(\"div\",{staticClass:\"info-list\"},[n(\"div\",{staticClass:\"response-info-title\"},[t._v(\"Status:\")]),n(\"div\",{class:t.result_css.status_code_type},[t._v(t._s(t.case_detail.status_code)+\" \"+t._s(t.case_detail.message))]),n(\"div\",{staticClass:\"response-info-title\"},[t._v(\"Time:\")]),n(\"div\",{class:t.result_css.time_type},[t._v(t._s(t.case_detail.response_time)+\" ms\")])])]),t.case_choose&&0!==t.case_detail.expected_res.length?n(\"assertions-detail\",{staticClass:\"assert\",attrs:{result:t.case_detail.expected_res}}):t._e(),n(\"div\",{staticClass:\"response-text\"},[t._v(t._s(t.case_detail.text))])],1)])],1)},r=[],a=n(\"a34a\"),i=n.n(a),c=n(\"07d6\"),o=n(\"595f\");function u(t,e){return h(t)||p(t,e)||l()}function l(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}function p(t,e){var n=[],s=!0,r=!1,a=void 0;try{for(var i,c=t[Symbol.iterator]();!(s=(i=c.next()).done);s=!0)if(n.push(i.value),e&&n.length===e)break}catch(o){r=!0,a=o}finally{try{s||null==c[\"return\"]||c[\"return\"]()}finally{if(r)throw a}}return n}function h(t){if(Array.isArray(t))return t}function d(t,e,n,s,r,a,i){try{var c=t[a](i),o=c.value}catch(u){return void n(u)}c.done?e(o):Promise.resolve(o).then(s,r)}function f(t){return function(){var e=this,n=arguments;return new Promise(function(s,r){var a=t.apply(e,n);function i(t){d(a,s,r,i,c,\"next\",t)}function c(t){d(a,s,r,i,c,\"throw\",t)}i(void 0)})}}var v={components:{AssertionsDetail:o[\"default\"]},data:function(){return{report_id:null,collection_id:null,report_loading:!0,total_count:0,percentage:0,result_list:[],case_detail:{},case_choose:!1,chartSettings:{radius:[65,45],hoverAnimation:!1,label:{show:!1}},chartExtend:{graphic:[{type:\"text\",left:\"center\",top:\"45%\",style:{text:0,textAlign:\"center\",fill:\"#000\",fontSize:28}},{type:\"text\",left:\"center\",top:\"55%\",style:{text:\"请求\",textAlign:\"center\",fill:\"#999999\",fontSize:16}}],color:[\"#00C292\",\"#E46A76\"]},chartData:{columns:[\"type\",\"count\"],rows:[{type:\"成功\",count:0},{type:\"失败\",count:0}]},result_css:{status_code_type:\"success\",time_type:\"success\"}}},watch:{total_count:function(t){this.chartExtend.graphic[0].style.text=t}},mounted:function(){this.pageInit()},destroyed:function(){this.websocket&&this.websocket.close()},methods:{pageInit:function(){var t=f(i.a.mark(function t(){var e,n,s;return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.report_id=this.$route.params.id,e=this.report_id.split(\"_\"),n=u(e,1),s=n[0],this.collection_id=s,t.next=5,this.getReportDetail();case 5:if(t.sent){t.next=7;break}this.initWebSocket();case 7:case\"end\":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getReportDetail:function(){var t=f(i.a.mark(function t(){var e;return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c[\"default\"].getReportDetail(this.report_id);case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt(\"return\",!1);case 5:return this.report_loading=!1,this.dataInit(e),t.abrupt(\"return\",!0);case 8:case\"end\":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),dataInit:function(t){var e=t.pass_count,n=t.error_count,s=t.result;this.total_count=e+n,this.chartData.rows[0].count=e,this.chartData.rows[1].count=n,this.result_list=s},initWebSocket:function(){var t=\"ws://127.0.0.1:5001/ws/message\";this.websocket=new WebSocket(t),this.websocket.onmessage=this.websocketOnMessage,this.websocket.onopen=this.websocketOnOpen,this.websocket.onerror=this.websocketOnError,this.websocket.onclose=this.websocketClose},websocketOnOpen:function(){console.log(\"建立连接\")},websocketOnError:function(){this.initWebSocket()},websocketOnMessage:function(){var t=f(i.a.mark(function t(e){var n,s,r,a;return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(e.data),n=e.data.split(\"_\"),s=u(n,2),r=s[0],a=s[1],r===this.collection_id){t.next=4;break}return t.abrupt(\"return\");case 4:if(this.percentage=Number(a),100!==Number(a)){t.next=11;break}return this.websocket.close(),t.next=9,new Promise(function(t){setTimeout(function(){return t(\"done!\")},2e3)});case 9:return t.next=11,this.getReportDetail();case 11:case\"end\":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),websocketSend:function(t){this.websocket.send(t)},websocketClose:function(t){console.log(\"断开连接\",t)},getCaseDetail:function(t){this.case_choose=!0,this.result_list.forEach(function(t){t.is_choose=!1}),t.is_choose=!0,this.case_detail=t}}},_=v,w=(n(\"3c12\"),n(\"2877\")),b=Object(w[\"a\"])(_,s,r,!1,null,\"44fe797e\",null);e[\"default\"]=b.exports}}]);","extractedComments":[]}