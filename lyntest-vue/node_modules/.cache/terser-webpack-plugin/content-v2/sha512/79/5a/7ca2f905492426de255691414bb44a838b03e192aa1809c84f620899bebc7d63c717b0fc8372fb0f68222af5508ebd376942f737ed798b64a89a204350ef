{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-14aabeb4\",\"chunk-481ad1f6\",\"chunk-2d229405\"],{\"0f63\":function(e,t,n){},\"387e\":function(e,t,n){\"use strict\";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.result.loading,expression:\"result.loading\"}]},[n(\"el-input\",{attrs:{placeholder:\"模块搜索\",size:\"small\"},scopedSlots:e._u([\"edit\"===e.type?{key:\"append\",fn:function(){return[n(\"el-button\",{attrs:{disabled:e.disabled,icon:\"el-icon-folder-add\"},on:{click:function(t){return e.openEditNodeDialog(\"add\")}}})]},proxy:!0}:null],null,!0),model:{value:e.filterText,callback:function(t){e.filterText=t},expression:\"filterText\"}}),n(\"el-tree\",{ref:\"tree\",staticClass:\"filter-tree node-tree\",attrs:{data:e.treeNodes,\"default-expanded-keys\":e.expandedNode,\"node-key\":\"id\",\"filter-node-method\":e.filterNode,\"expand-on-click-node\":!1,\"highlight-current\":\"\",draggable:e.draggable,props:e.defaultProps},on:{\"node-drag-end\":e.handleDragEnd,\"node-expand\":e.nodeExpand,\"node-collapse\":e.nodeCollapse},scopedSlots:e._u([{key:\"default\",fn:function(t){var r=t.node,i=t.data;return[n(\"span\",{staticClass:\"custom-tree-node father\",on:{click:function(t){return e.handleNodeSelect(r)}}},[n(\"span\",{staticClass:\"node-icon\"},[n(\"i\",{staticClass:\"el-icon-folder\"})]),n(\"span\",{staticClass:\"node-title\"},[e._v(e._s(r.label))]),\"edit\"!==e.type||e.disabled?e._e():n(\"span\",{staticClass:\"node-operate child\"},[n(\"el-tooltip\",{staticClass:\"item\",attrs:{effect:\"dark\",\"open-delay\":200,content:\"重命名\",placement:\"top\"}},[n(\"i\",{staticClass:\"el-icon-edit\",on:{click:function(t){return t.stopPropagation(),e.openEditNodeDialog(\"edit\",i)}}})]),n(\"el-tooltip\",{staticClass:\"item\",attrs:{effect:\"dark\",\"open-delay\":200,content:\"添加子模块\",placement:\"top\"}},[n(\"i\",{staticClass:\"el-icon-circle-plus-outline\",on:{click:function(t){return t.stopPropagation(),e.openEditNodeDialog(\"add\",i)}}})]),n(\"el-tooltip\",{staticClass:\"item\",attrs:{effect:\"dark\",\"open-delay\":200,content:\"删除\",placement:\"top\"}},[n(\"i\",{staticClass:\"el-icon-delete\",on:{click:function(t){return t.stopPropagation(),e.remove(r,i)}}})])],1)])]}}])}),n(\"node-edit\",{ref:\"nodeEdit\",attrs:{\"current-project\":e.currentProject,\"tree-nodes\":e.treeNodes},on:{refresh:e.refreshNode}}),n(\"el-dialog\",{attrs:{visible:e.confirmDeleteDialog,width:\"30%\"},on:{\"update:visible\":function(t){e.confirmDeleteDialog=t}}},[n(\"span\",[e._v(\"删除模块同时,其子模块及测试用例会全被删除，是否继续删除？\")]),n(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[n(\"el-button\",{on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v(\"取 消\")]),n(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.confirmRemove}},[e._v(\"确 定\")])],1)])],1)},i=[],a=n(\"a34a\"),o=n.n(a),s=n(\"abab\"),d=n(\"dd3b\");function c(e,t,n,r,i,a,o){try{var s=e[a](o),d=s.value}catch(c){return void n(c)}s.done?t(d):Promise.resolve(d).then(r,i)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){c(a,r,i,o,s,\"next\",e)}function s(e){c(a,r,i,o,s,\"throw\",e)}o(void 0)})}}var u={name:\"node-tree\",components:{NodeEdit:s[\"default\"]},data:function(){return{result:{},expandedNode:[],filterText:\"\",defaultProps:{children:\"children\",label:\"name\"},disabled:!1,list:[],confirmDeleteDialog:!1,removeNodeIds:[]}},props:{type:{type:String,default:\"view\"},treeNodes:{type:Array},selectNode:{type:Object},draggable:{type:Boolean,default:!0},currentProject:{type:Object}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},methods:{handleDragEnd:function(){var e=l(o.a.mark(function e(t,n,r){var i,a;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(\"none\"!==r&&void 0!==r){e.next=2;break}return e.abrupt(\"return\");case 2:return i=this.buildParam(t,n,r),this.list=[],this.getNodeTree(this.treeNodes,t.data.id,this.list),e.next=7,d[\"default\"].dragNode(i);case 7:if(a=e.sent,!(a.code<window.MAX_SUCCESS_CODE)){e.next=14;break}return e.next=11,d[\"default\"].nodePosition(this.list);case 11:this.$emit(\"refresh\"),e.next=15;break;case 14:this.$message.error(\"服务端异常\");case 15:case\"end\":return e.stop()}},e,this)}));function t(t,n,r){return e.apply(this,arguments)}return t}(),buildParam:function(e,t,n){var r,i=this;return 1===t.level&&\"inner\"!==n?r=e.data:this.treeNodes.some(function(e){return r=i.findTreeByNodeId(e,t.data.id),r}),r},getNodeTree:function(e,t,n){if(e)for(var r=0;r<e.length;r++){if(e[r].id===t)return n[0]=r-1>=0?e[r-1].id:0,n[1]=e[r].id,void(n[2]=r+1<e.length?e[r+1].id:0);e[r].children&&this.getNodeTree(e[r].children,t,n)}},refreshTable:function(){this.$emit(\"refreshTable\")},findTreeByNodeId:function(e,t){if(e.id===t)return e;if(e.children)for(var n=0;n<e.children.length;n++)if(this.findTreeByNodeId(e.children[n],t))return e},remove:function(e){var t=[];this.getChildNodeId(e.data,t),this.removeNodeIds=t,this.confirmDeleteDialog=!0},confirmRemove:function(){var e=l(o.a.mark(function e(){var t;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d[\"default\"].deleteNodes(this.removeNodeIds);case 2:t=e.sent,t.code<window.MAX_SUCCESS_CODE?(this.$message.success(t.message),this.$emit(\"refresh\"),this.confirmDeleteDialog=!1):this.$message.error(\"服务端异常\");case 4:case\"end\":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleNodeSelect:function(e){var t=[],n=[];this.getChildNodeId(e.data,t),this.getParentNodes(e,n),this.$emit(\"nodeSelectEvent\",t,n),this.$emit(\"update:selectNode\",e)},getChildNodeId:function(e,t){if(t.push(e.id),e.children)for(var n=0;n<e.children.length;n++)this.getChildNodeId(e.children[n],t)},getParentNodes:function(e,t){e.parent&&0!==e.parent.id&&this.getParentNodes(e.parent,t),e.data.name&&\"\"!==e.data.name&&t.push(e.data)},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},openEditNodeDialog:function(e,t){var n=[];\"edit\"===e&&this.getChildNodeId(t,n),this.$refs.nodeEdit.open(e,t,n)},refreshNode:function(){this.$emit(\"refresh\")},nodeExpand:function(e){e.id&&this.expandedNode.push(e.id)},nodeCollapse:function(e){e.id&&this.expandedNode.splice(this.expandedNode.indexOf(e.id),1)}}},f=u,p=(n(\"703d\"),n(\"2877\")),h=Object(p[\"a\"])(f,r,i,!1,null,\"78fca324\",null);t[\"default\"]=h.exports},\"703d\":function(e,t,n){\"use strict\";var r=n(\"0f63\"),i=n.n(r);i.a},abab:function(e,t,n){\"use strict\";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"el-dialog\",{attrs:{title:\"edit\"===e.type?\"重命名\":\"添加\",visible:e.dialogFormVisible,\"before-close\":e.close,width:\"30%\"},on:{\"update:visible\":function(t){e.dialogFormVisible=t}}},[n(\"el-row\",{attrs:{type:\"flex\",justify:\"center\"}},[n(\"el-col\",{attrs:{span:18}},[n(\"el-form\",{ref:\"nodeForm\",attrs:{model:e.form},nativeOn:{submit:function(e){e.preventDefault()}}},[n(\"el-form-item\",{attrs:{label:\"模块名称\",\"label-width\":e.formLabelWidth,prop:\"name\"}},[n(\"el-input\",{model:{value:e.form.name,callback:function(t){e.$set(e.form,\"name\",t)},expression:\"form.name\"}})],1)],1)],1)],1),n(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[n(\"el-button\",{on:{click:e.close}},[e._v(\"取 消\")]),n(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.saveNode},nativeOn:{keydown:function(t){if(!t.type.indexOf(\"key\")&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\"))return null;t.preventDefault()}}},[e._v(\"保 存\")])],1)],1)},i=[],a=n(\"a34a\"),o=n.n(a),s=n(\"dd3b\");function d(e,t,n,r,i,a,o){try{var s=e[a](o),d=s.value}catch(c){return void n(c)}s.done?t(d):Promise.resolve(d).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){d(a,r,i,o,s,\"next\",e)}function s(e){d(a,r,i,o,s,\"throw\",e)}o(void 0)})}}var l={data:function(){return{name:\"node-edit\",form:{name:\"\"},type:\"\",node:{},nodeIds:[],formLabelWidth:\"80px\",dialogFormVisible:!1}},props:{treeNodes:{type:Array},currentProject:{type:Object}},methods:{open:function(e,t,n){this.type=e,this.node=t,\"edit\"===e&&(this.form.name=this.node.name),this.nodeIds=n,this.dialogFormVisible=!0},saveNode:function(){var e=c(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t={},t.name=this.form.name.trim(),t.label=this.form.name,t.project_id=this.currentProject.id,\"add\"!==this.type){e.next=12;break}return t.level=1,this.node&&(t.parent_id=this.node.id,t.level=this.node.level+1),e.next=9,s[\"default\"].createNode(t);case 9:n=e.sent,e.next=19;break;case 12:if(\"edit\"!==this.type){e.next=19;break}return t.id=this.node.id,t.level=this.node.level,t.nodeIds=this.nodeIds,e.next=18,s[\"default\"].updateNode(t);case 18:n=e.sent;case 19:n.code<window.MAX_SUCCESS_CODE?(this.$message.success(n.message),this.$emit(\"refresh\"),this.close()):this.$message.error(\"服务端异常\");case 20:case\"end\":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),close:function(){this.form.name=\"\",this.dialogFormVisible=!1}}},u=l,f=n(\"2877\"),p=Object(f[\"a\"])(u,r,i,!1,null,\"56d78c26\",null);t[\"default\"]=p.exports},dd3b:function(e,t,n){\"use strict\";n.r(t);var r=n(\"a34a\"),i=n.n(r),a=n(\"ceda\");function o(e,t,n,r,i,a,o){try{var s=e[a](o),d=s.value}catch(c){return void n(c)}s.done?t(d):Promise.resolve(d).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,d,\"next\",e)}function d(e){o(a,r,i,s,d,\"throw\",e)}s(void 0)})}}function d(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}var u=function(){function e(){d(this,e)}return l(e,[{key:\"createNode\",value:function(){var e=s(i.a.mark(function e(t){var n;return i.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a[\"post\"])(\"/track/node/create\",t);case 2:return n=e.sent,e.abrupt(\"return\",n);case 4:case\"end\":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:\"getNodeByProjectId\",value:function(){var e=s(i.a.mark(function e(t){var n;return i.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a[\"get\"])(\"/track/node/\".concat(t));case 2:return n=e.sent,e.abrupt(\"return\",n);case 4:case\"end\":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:\"updateNode\",value:function(){var e=s(i.a.mark(function e(t){var n;return i.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a[\"post\"])(\"/track/node/update\",t);case 2:return n=e.sent,e.abrupt(\"return\",n);case 4:case\"end\":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:\"deleteNodes\",value:function(){var e=s(i.a.mark(function e(t){var n;return i.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a[\"post\"])(\"/track/node/delete\",t);case 2:return n=e.sent,e.abrupt(\"return\",n);case 4:case\"end\":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:\"dragNode\",value:function(){var e=s(i.a.mark(function e(t){var n;return i.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a[\"post\"])(\"/track/node/drag\",t);case 2:return n=e.sent,e.abrupt(\"return\",n);case 4:case\"end\":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:\"nodePosition\",value:function(){var e=s(i.a.mark(function e(t){var n;return i.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a[\"post\"])(\"/track/node/position\",t);case 2:return n=e.sent,e.abrupt(\"return\",n);case 4:case\"end\":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()}]),e}();t[\"default\"]=new u}}]);","extractedComments":[]}