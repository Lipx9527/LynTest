{"remainingRequest":"/Users/lyn/Desktop/mmdz_ceshi/lyntest-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lyn/Desktop/mmdz_ceshi/lyntest-vue/src/view/login/login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lyn/Desktop/mmdz_ceshi/lyntest-vue/src/view/login/login.vue","mtime":1606914012011},{"path":"/Users/lyn/Desktop/mmdz_ceshi/lyntest-vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lyn/Desktop/mmdz_ceshi/lyntest-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lyn/Desktop/mmdz_ceshi/lyntest-vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapActions, mapMutations } from 'vuex'\nimport User from '@/lin/model/user'\nimport Utils from '@/lin/util/util'\n\nexport default {\n  name: 'login',\n  data() {\n    return {\n      loading: false, // 加载动画\n      wait: 2000, // 2000ms之内不能重复发起请求\n      throttleLogin: null, // 节流登录\n      form: {\n        code: '',\n        password: '',\n      },\n    }\n  },\n  methods: {\n    async login() {\n      const { code, password } = this.form\n      try {\n        this.loading = true\n        await User.getToken(code, password)\n        await this.getInformation()\n        this.loading = false\n        this.$router.push('/api-test/http')\n        this.$message.success('登录成功')\n      } catch (e) {\n        this.loading = false\n        console.log(e)\n      }\n    },\n    async getInformation() {\n      try {\n        // 尝试获取当前用户信息\n        const user = await User.getPermissions()\n        this.setUserAndState(user)\n        this.setUserPermissions(user.permissions)\n      } catch (e) {\n        console.log(e)\n      }\n    },\n    ...mapActions(['setUserAndState']),\n    ...mapMutations({\n      setUserPermissions: 'SET_USER_PERMISSIONS',\n    }),\n  },\n  created() {\n    // 节流登录\n    this.throttleLogin = Utils.throttle(this.login, this.wait)\n  },\n  components: {},\n}\n",null]}